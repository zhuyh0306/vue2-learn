{"version":3,"file":"index.js","sources":["../src/utils.js","../src/observe/arr.js","../src/observe/index.js","../src/initState.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isObject(obj) {\n    //判断是否是对象\n    return obj !== null && typeof obj === 'object'\n}","\n//重写数组方法\n//（1）获取原来的数组方法\nlet oldArrayProtoMethods = Array.prototype\n//（2）继承\n\nexport let arrayMethods = Object.create(oldArrayProtoMethods)\n//劫持\n\nlet methods = [\n    'push',\n    'pop',\n    'unshift',\n    'shift',\n    'splice',\n    'sort',\n    'reverse'\n]\n\nmethods.forEach((item) => {\n    arrayMethods[item] = function (...args) {\n        console.log('数组劫持了')\n        oldArrayProtoMethods[item].apply(this,args)\n    }\n})","import { isObject } from \"../utils\"\nimport {arrayMethods} from './arr'\nexport function observe(data) {\n    // 判断如果不是对象,直接return\n    if (!isObject(data)) {\n        return data\n    }\n    new Observer(data)\n\n}\n// Observer类的作用：因为Object.defineProperty只能对对象的一个熟悉进行劫持，封装后可以对对象进行劫持\nclass Observer {\n    constructor(value) {\n        if (Array.isArray(value)) {\n            // @ts-ignore\n            value.__proto__ = arrayMethods\n            this.observeArray(value)\n        } else {\n            this.walk(value)\n        }\n        \n    }\n    walk(value) {\n        let keys = Object.keys(value);\n        keys.forEach(key => {\n            //对每个属性进行劫持 \n            defineReactive(value,key,value[key])\n        });\n    }\n    observeArray(value) {\n        value.forEach(item => {\n            observe(item)\n        });\n    }\n}\n\nfunction defineReactive(data, key, value) {\n    observe(value)\n    Object.defineProperty(data,key, {\n        get() {\n            console.log('获取value值',data,key)\n            return value\n        }, \n        set(newVal) {\n            if (newVal === value) return\n            console.log('set')\n            // 如果设置的值是对象，还要深度劫持\n            observe(newVal)\n            value = newVal\n        }\n    })\n}","import { observe} from \"./observe/index\"\n\nexport function initState(vm) {\n    let opt = vm.$options\n    console.log(opt)\n    if (opt.props) {\n        initProps(vm)\n    }\n    if (opt.methods) {\n        initMethods(vm)\n    }\n    if (opt.data) {\n        initData(vm)\n    }\n    if (opt.computed) {\n        initComputed(vm)\n    }\n    if (opt.watch) { \n        initWatch(vm)\n    }\n}\nfunction initProps(vm) {\n    console.log('initProps')\n}\n\nfunction initMethods(vm) {\n    console.log('initMethods')\n    \n}\n/**\n * 初始化data\n */\nfunction initData(vm) {\n\n    console.log('initData')\n    let data = vm.$options.data;\n    data = typeof data === 'function' ? data.call(vm) : data\n    vm._data = data\n    //对数据进行劫持\n    observe(data)\n\n}\nfunction initComputed(vm) {\n    console.log('initComputed')\n}\nfunction initWatch(vm) {\n    console.log('initWatch')\n}","import { initState } from \"./initState\";\n\nexport function initMixin(Vue) {\n    Vue.prototype._init = function (options) {\n        console.log(options)\n        const vm = this;\n        vm.$options = options;\n        //初始化状态\n        initState(vm)\n    }\n}","import {initMixin} from './init'\nfunction Vue(options) {\n\n//初始化  \n this._init(options)\n}\ninitMixin(Vue) \nexport default Vue\n"],"names":["isObject","obj","_typeof","oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","item","console","log","_len","arguments","length","args","_key","apply","observe","data","Observer","value","_classCallCheck","isArray","__proto__","observeArray","walk","_createClass","key","keys","defineReactive","defineProperty","get","set","newVal","initState","vm","opt","$options","props","initProps","initMethods","initData","computed","initComputed","watch","initWatch","call","_data","initMixin","Vue","_init","options"],"mappings":"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"}